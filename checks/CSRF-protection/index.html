<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Testomato Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Testomato Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-31717225-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">CSRF protection | Testomato</title><meta data-react-helmet="true" property="og:url" content="https://help.testomato.com//checks/CSRF-protection"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="CSRF protection | Testomato"><meta data-react-helmet="true" name="description" content="Testomato &amp; CSRF protecion"><meta data-react-helmet="true" property="og:description" content="Testomato &amp; CSRF protecion"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://help.testomato.com//checks/CSRF-protection"><link data-react-helmet="true" rel="alternate" href="https://help.testomato.com//checks/CSRF-protection" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://help.testomato.com//checks/CSRF-protection" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6c9231bd.css">
<link rel="preload" href="/assets/js/styles.83a2285e.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.404c0993.js" as="script">
<link rel="preload" href="/assets/js/main.cc8bf5f9.js" as="script">
<link rel="preload" href="/assets/js/1.b8712aec.js" as="script">
<link rel="preload" href="/assets/js/2.c7f1ecb6.js" as="script">
<link rel="preload" href="/assets/js/42.3c662b0f.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.749f6016.js" as="script">
<link rel="preload" href="/assets/js/17896441.23d18ddb.js" as="script">
<link rel="preload" href="/assets/js/f1bf5453.c35cbd94.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Testomato Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Testomato Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Help &amp; Docs</strong></a><a class="navbar__item navbar__link" href="/introduction">Testomato</a><a class="navbar__item navbar__link" href="/api/introduction">REST API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/testomato/help.testomato.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Testomato Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Testomato Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Help &amp; Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/introduction">Testomato</a></li><li class="menu__list-item"><a class="menu__link" href="/api/introduction">REST API</a></li><li class="menu__list-item"><a href="https://github.com/testomato/help.testomato.com" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/dashboard">Dashboard</a></li><li class="menu__list-item"><a class="menu__link" href="/account">Account</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Payments</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payment/payment">Payment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payment/credit-card">Credit card payment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payment/paypal-payments">PayPal payments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payment/bank-transfer">Bank Transfer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payment/invoices">Invoices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payment/subscription">Subscriptions FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/monitoring/uptime">Uptime monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/monitoring/http">Hypertext Transfer Protocol</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">TestomatoBot</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bot/about">About</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/bot/ddos">DDoS protection</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Checks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/checks/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/checks/string-checks">String checks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/checks/semantic">Semantic checks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/checks/redirect">Redirect check</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/checks/common-server-errors">Common Server Errors</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/checks/CSRF-protection">CSRF protection</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/api-key">How to Get API Key</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/common-responses">Common responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/example-page">Example page</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Project</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/get-project">Get Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-start">Starting Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-results">Project Results</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-simple-status">Project Simple Status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-status">Project Status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-response-times">Project Response Times</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-users">Project Users</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/project/project-group">Project Groups</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/incident">Incident</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/user-projects">User Projects</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/support">Contact Support</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">CSRF protection</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testomato--csrf-protecion"></a>Testomato &amp; CSRF protecion<a class="hash-link" href="#testomato--csrf-protecion" title="Direct link to heading">#</a></h2><p>Can Testomato hadle forms with CSRF protecion. The simply answer is NO.
If your application is protected from cross-site request forgery attacks, it&#x27;s also
preventing Testomato from sending requests with <a href="https://github.com/testomato/minicrawler" target="_blank" rel="noopener noreferrer">minicralwer</a>, but we can try to
bridge the simplest type of protection by doubling the request.</p><ul><li><strong>During the first request</strong>, Testomato ignores HTTP response code -
usually there’s some sort of unauthorized request response,
but we update all hidden form params values and save the session.</li><li><strong>The second request</strong> is submitted within the same session in the hopes that one of the hidden params has a valid CSRF token</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="whats-csrf-protecion"></a>What&#x27;s CSRF protecion<a class="hash-link" href="#whats-csrf-protecion" title="Direct link to heading">#</a></h2><p><a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank" rel="noopener noreferrer">Cross-site request forgeries</a> are a type of malicious
exploit where unauthorized commands are performed on behalf of an authenticated user.</p><p>In case you&#x27;re not familiar with cross-site request forgeries, let&#x27;s discuss an example of how this
vulnerability can be exploited. Imagine your application has a <code>/user/email</code> route that accepts a
<code>POST</code> request to change the authenticated user&#x27;s email address. Most likely, this route expects
an email input field to contain the email address the user would like to begin using.</p><p>Without CSRF protection, a malicious website could create an HTML form that points to your
application&#x27;s <code>/user/email</code> route and submits the malicious user&#x27;s own email address</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><div tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">form</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">action</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://your-application.com/user/email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">method</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">POST</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">malicious-email@example.com</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">form</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">forms</span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">submit</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="preventing-csrf-requests"></a>Preventing CSRF Requests<a class="hash-link" href="#preventing-csrf-requests" title="Direct link to heading">#</a></h3><p>You can generate CSRF &quot;token&quot; for each active user session managed by the application.
This token is used to verify that the authenticated user is the person actually making
the requests to the application. Since this token is stored in the user&#x27;s session
and changes each time the session is regenerated, a malicious application is unable to access it.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">session_start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">empty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$_SESSION</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$_SESSION</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bin2hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">random_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$token</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_SESSION</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">form action</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;https://your-application.com/user/email&quot;</span><span class="token plain"> method</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;POST&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input type</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;malicious-email@example.com&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input type</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;hidden&quot;</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;token&quot;</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;&lt;?php echo </span><span class="token double-quoted-string string interpolation variable" style="color:#36acaa">$token</span><span class="token double-quoted-string string" style="color:#e3116c"> ?&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">form</span><span class="token operator" style="color:#393A34">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Anytime you define an HTML form in your application,
you should include a hidden CSRF <code>_token</code> field in the
form so that the CSRF protection can validate the request.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token keyword" style="color:#00009f">empty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">hash_equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$_SESSION</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// Proceed to process the form data</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// Log this as a warning and keep an eye on these attempts</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="per-form-tokens"></a>Per-Form Tokens<a class="hash-link" href="#per-form-tokens" title="Direct link to heading">#</a></h3><p>You can go even further and generate Per-Form Tokens for every single
form on your application:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$second_token</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hash_hmac</span><span class="token punctuation" style="color:#393A34">(</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;/my_form.php&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_SESSION</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;second_token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input type</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;hidden&quot;</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;token&quot;</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token double-quoted-string string" style="color:#e3116c">&quot;&lt;?php echo </span><span class="token double-quoted-string string interpolation variable" style="color:#36acaa">$second_token</span><span class="token double-quoted-string string" style="color:#e3116c"> ?&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$calc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hash_hmac</span><span class="token punctuation" style="color:#393A34">(</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;/my_form.php&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_SESSION</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;second_token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">hash_equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$calc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token single-quoted-string string" style="color:#e3116c">&#x27;token&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Continue...</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can also change the name of the token variable or invalidate a token
periodically in time. If you have a security requirement that each CSRF
token is allowed to be usable exactly once, the simplest strategy
is to regenerate it after each successful validation.
However, doing so will invalidate every previous token which doesn&#x27;t
mix well with people who browse multiple tabs at once.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="resources"></a>Resources<a class="hash-link" href="#resources" title="Direct link to heading">#</a></h2><ul><li><a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank" rel="noopener noreferrer">Cross-site request forgeries</a></li><li><a href="https://laravel.com/docs/8.x/csrf#csrf-explanation" target="_blank" rel="noopener noreferrer">CSRF Protection with Laravel</a></li><li><a href="https://symfony.com/doc/current/security/csrf.html" target="_blank" rel="noopener noreferrer">CSRF Protection with Symfony</a></li><li><a href="http://expressjs.com/en/resources/middleware/csurf.html" target="_blank" rel="noopener noreferrer">CSRF Protection with Express.js</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/testomato/help.testomato.com/edit/master/docs/checks/06-CSRF-protection.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-04-27T07:37:10.000Z" class="lastUpdatedDate_1WI_">4/27/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/checks/common-server-errors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Common Server Errors</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/api/introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testomato REST API »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#testomato--csrf-protecion" class="table-of-contents__link">Testomato &amp; CSRF protecion</a></li><li><a href="#whats-csrf-protecion" class="table-of-contents__link">What&#39;s CSRF protecion</a><ul><li><a href="#preventing-csrf-requests" class="table-of-contents__link">Preventing CSRF Requests</a></li><li><a href="#per-form-tokens" class="table-of-contents__link">Per-Form Tokens</a></li></ul></li><li><a href="#resources" class="table-of-contents__link">Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Testomato</h4><ul class="footer__items"><li class="footer__item"><a href="https://testomato.com/contact" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us</a></li><li class="footer__item"><a href="https://www.testomato.com/team" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testomato Team</a></li><li class="footer__item"><a href="https://www.testomato.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Testomato</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social networks</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.testomato.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/testomato" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://www.facebook.com/testomato" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/testomatocom" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/assets/js/styles.83a2285e.js"></script>
<script src="/assets/js/runtime~main.404c0993.js"></script>
<script src="/assets/js/main.cc8bf5f9.js"></script>
<script src="/assets/js/1.b8712aec.js"></script>
<script src="/assets/js/2.c7f1ecb6.js"></script>
<script src="/assets/js/42.3c662b0f.js"></script>
<script src="/assets/js/935f2afb.749f6016.js"></script>
<script src="/assets/js/17896441.23d18ddb.js"></script>
<script src="/assets/js/f1bf5453.c35cbd94.js"></script>
</body>
</html>